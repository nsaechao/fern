imports:
  root: __package__.yml
service:
  auth: false
  base-path: ''
  endpoints:
    list:
      path: /v2/customers
      method: GET
      auth: true
      docs: >-
        Lists customer profiles associated with a Square account.


        Under normal operating conditions, newly created or updated customer
        profiles become available

        for the listing operation in well under 30 seconds. Occasionally,
        propagation of the new or updated

        profiles can take closer to one minute or longer, especially during
        network incidents and outages.
      pagination:
        cursor: $request.cursor
        next_cursor: $response.cursor
        results: $response.customers
      display-name: ListCustomers
      request:
        name: CustomersListRequest
        query-parameters:
          cursor:
            type: optional<string>
            docs: >-
              A pagination cursor returned by a previous call to this endpoint.

              Provide this cursor to retrieve the next set of results for your
              original query.


              For more information, see
              [Pagination](https://developer.squareup.com/docs/build-basics/common-api-patterns/pagination).
          limit:
            type: optional<integer>
            docs: >-
              The maximum number of results to return in a single page. This
              limit is advisory. The response might contain more or fewer
              results.

              If the specified limit is less than 1 or greater than 100, Square
              returns a `400 VALUE_TOO_LOW` or `400 VALUE_TOO_HIGH` error. The
              default value is 100.


              For more information, see
              [Pagination](https://developer.squareup.com/docs/build-basics/common-api-patterns/pagination).
          sort_field:
            type: optional<root.CustomerSortField>
            docs: |-
              Indicates how customers should be sorted.

              The default value is `DEFAULT`.
          sort_order:
            type: optional<root.SortOrder>
            docs: >-
              Indicates whether customers should be sorted in ascending (`ASC`)
              or

              descending (`DESC`) order.


              The default value is `ASC`.
      response:
        docs: Success
        type: root.ListCustomersResponse
      examples:
        - response:
            body:
              errors:
                - category: API_ERROR
                  code: INTERNAL_SERVER_ERROR
                  detail: detail
                  field: field
              customers:
                - id: JDKYHBWT1D4F8MFH63DBMEN8Y4
                  created_at: '2016-03-23T20:21:54.859Z'
                  updated_at: '2016-03-23T20:21:55Z'
                  cards:
                    - {}
                  given_name: Amelia
                  family_name: Earhart
                  nickname: nickname
                  company_name: company_name
                  email_address: Amelia.Earhart@example.com
                  address:
                    address_line_1: 500 Electric Ave
                    address_line_2: Suite 600
                    locality: New York
                    administrative_district_level_1: NY
                    postal_code: '10003'
                    country: US
                  phone_number: 1-212-555-4240
                  birthday: birthday
                  reference_id: YOUR_REFERENCE_ID
                  note: a customer
                  preferences:
                    email_unsubscribed: false
                  groups:
                    - id: id
                      name: name
                  creation_source: THIRD_PARTY
                  group_ids:
                    - 545AXB44B4XXWMVQ4W8SBT3HHF
                  segment_ids:
                    - 1KB9JE5EGJXCW.REACHABLE
                  version: 1
              cursor: cursor
    create:
      path: /v2/customers
      method: POST
      auth: true
      docs: >-
        Creates a new customer for a business.


        You must provide at least one of the following values in your request to
        this

        endpoint:


        - `given_name`

        - `family_name`

        - `company_name`

        - `email_address`

        - `phone_number`
      display-name: CreateCustomer
      request:
        name: CreateCustomerRequest
        body:
          properties:
            idempotency_key:
              type: optional<string>
              docs: "The idempotency key for the request.\tFor more information, see\n[Idempotency](https://developer.squareup.com/docs/build-basics/common-api-patterns/idempotency)."
            given_name:
              type: optional<string>
              docs: >-
                The given name (that is, the first name) associated with the
                customer profile.
            family_name:
              type: optional<string>
              docs: >-
                The family name (that is, the last name) associated with the
                customer profile.
            company_name:
              type: optional<string>
              docs: A business name associated with the customer profile.
            nickname:
              type: optional<string>
              docs: A nickname for the customer profile.
            email_address:
              type: optional<string>
              docs: The email address associated with the customer profile.
            address:
              type: optional<root.Address>
              docs: The physical address associated with the customer profile.
            phone_number:
              type: optional<string>
              docs: >-
                The phone number associated with the customer profile. A phone
                number can contain 9–16 digits, with an optional `+` prefix.
            reference_id:
              type: optional<string>
              docs: >-
                An optional second ID used to associate the customer profile
                with an

                entity in another system.
            note:
              type: optional<string>
              docs: A custom note associated with the customer profile.
            birthday:
              type: optional<string>
              docs: >-
                The birthday associated with the customer profile, in RFC 3339
                format. The year is optional. The timezone and time are not
                allowed.

                For example, `0000-09-21T00:00:00-00:00` represents a birthday
                on September 21 and `1998-09-21T00:00:00-00:00` represents a
                birthday on September 21, 1998.

                You can also specify this value in `YYYY-MM-DD` format.
            tax_ids:
              type: optional<root.CustomerTaxIds>
              docs: >-
                The tax ID associated with the customer profile. This field is
                available only for customers of sellers in EU countries or the
                United Kingdom. 

                In other countries, this field is ignored when included in a
                `CreateCustomer` request. For more information, 

                see [Customer tax
                IDs](https://developer.squareup.com/docs/customers-api/what-it-does#customer-tax-ids).
      response:
        docs: Success
        type: root.CreateCustomerResponse
      examples:
        - request:
            given_name: Amelia
            family_name: Earhart
            email_address: Amelia.Earhart@example.com
            address:
              address_line_1: 500 Electric Ave
              address_line_2: Suite 600
              locality: New York
              administrative_district_level_1: NY
              postal_code: '10003'
              country: US
            phone_number: 1-212-555-4240
            reference_id: YOUR_REFERENCE_ID
            note: a customer
          response:
            body:
              errors:
                - category: API_ERROR
                  code: INTERNAL_SERVER_ERROR
                  detail: detail
                  field: field
              customer:
                id: JDKYHBWT1D4F8MFH63DBMEN8Y4
                created_at: '2016-03-23T20:21:54.859Z'
                updated_at: '2016-03-23T20:21:54.859Z'
                cards:
                  - {}
                given_name: Amelia
                family_name: Earhart
                nickname: nickname
                company_name: company_name
                email_address: Amelia.Earhart@example.com
                address:
                  address_line_1: 500 Electric Ave
                  address_line_2: Suite 600
                  address_line_3: address_line_3
                  locality: New York
                  sublocality: sublocality
                  sublocality_2: sublocality_2
                  sublocality_3: sublocality_3
                  administrative_district_level_1: NY
                  administrative_district_level_2: administrative_district_level_2
                  administrative_district_level_3: administrative_district_level_3
                  postal_code: '10003'
                  country: US
                  first_name: first_name
                  last_name: last_name
                phone_number: 1-212-555-4240
                birthday: birthday
                reference_id: YOUR_REFERENCE_ID
                note: a customer
                preferences:
                  email_unsubscribed: false
                groups:
                  - id: id
                    name: name
                creation_source: THIRD_PARTY
                group_ids:
                  - group_ids
                segment_ids:
                  - segment_ids
                version: 0
                tax_ids:
                  eu_vat: eu_vat
    batchUpsertAttributes:
      path: /v2/customers/custom-attributes/bulk-upsert
      method: POST
      auth: true
      docs: >-
        Creates or updates [custom attributes](entity:CustomAttribute) for
        customer profiles as a bulk operation.


        Use this endpoint to set the value of one or more custom attributes for
        one or more customer profiles.

        A custom attribute is based on a custom attribute definition in a Square
        seller account, which is

        created using the
        [CreateCustomerCustomAttributeDefinition](api-endpoint:CustomerCustomAttributes-CreateCustomerCustomAttributeDefinition)
        endpoint.


        This `BulkUpsertCustomerCustomAttributes` endpoint accepts a map of 1 to
        25 individual upsert 

        requests and returns a map of individual upsert responses. Each upsert
        request has a unique ID 

        and provides a customer ID and custom attribute. Each upsert response is
        returned with the ID 

        of the corresponding request.


        To create or update a custom attribute owned by another application, the
        `visibility` setting

        must be `VISIBILITY_READ_WRITE_VALUES`. Note that seller-defined custom
        attributes

        (also known as custom fields) are always set to
        `VISIBILITY_READ_WRITE_VALUES`.
      display-name: BulkUpsertCustomerCustomAttributes
      request:
        name: BatchUpsertCustomerCustomAttributesRequest
        body:
          properties:
            values:
              type: >-
                map<string,
                root.BatchUpsertCustomerCustomAttributesRequestCustomerCustomAttributeUpsertRequest>
              docs: >-
                A map containing 1 to 25 individual upsert requests. For each
                request, provide an

                arbitrary ID that is unique for this
                `BulkUpsertCustomerCustomAttributes` request and the

                information needed to create or update a custom attribute.
      response:
        docs: Success
        type: root.BatchUpsertCustomerCustomAttributesResponse
      examples:
        - request:
            values:
              id1:
                customer_id: N3NCVYY3WS27HF0HKANA3R9FP8
                custom_attribute:
                  key: favoritemovie
                  value: Dune
              id2:
                customer_id: SY8EMWRNDN3TQDP2H4KS1QWMMM
                custom_attribute:
                  key: ownsmovie
                  value: false
              id3:
                customer_id: SY8EMWRNDN3TQDP2H4KS1QWMMM
                custom_attribute:
                  key: favoritemovie
                  value: Star Wars
              id4:
                customer_id: N3NCVYY3WS27HF0HKANA3R9FP8
                custom_attribute:
                  key: square:a0f1505a-2aa1-490d-91a8-8d31ff181808
                  value: '10.5'
              id5:
                customer_id: 70548QG1HN43B05G0KCZ4MMC1G
                custom_attribute:
                  key: sq0ids-0evKIskIGaY45fCyNL66aw:backupemail
                  value: fake-email@squareup.com
          response:
            body:
              values:
                id2:
                  customer_id: SY8EMWRNDN3TQDP2H4KS1QWMMM
                  custom_attribute:
                    key: ownsmovie
                    value: false
                    version: 2
                    visibility: VISIBILITY_READ_WRITE_VALUES
                    updated_at: '2021-12-09T00:16:23Z'
                    created_at: '2021-12-09T00:16:20Z'
                  errors:
                    - category: API_ERROR
                      code: INTERNAL_SERVER_ERROR
                id1:
                  customer_id: N3NCVYY3WS27HF0HKANA3R9FP8
                  custom_attribute:
                    key: favoritemovie
                    value: Dune
                    version: 1
                    visibility: VISIBILITY_READ_WRITE_VALUES
                    updated_at: '2021-12-09T00:16:23Z'
                    created_at: '2021-12-08T23:14:47Z'
                  errors:
                    - category: API_ERROR
                      code: INTERNAL_SERVER_ERROR
                id3:
                  customer_id: SY8EMWRNDN3TQDP2H4KS1QWMMM
                  custom_attribute:
                    key: favoritemovie
                    value: Star Wars
                    version: 2
                    visibility: VISIBILITY_READ_WRITE_VALUES
                    updated_at: '2021-12-09T00:16:23Z'
                    created_at: '2021-12-09T00:16:20Z'
                  errors:
                    - category: API_ERROR
                      code: INTERNAL_SERVER_ERROR
                id4:
                  customer_id: N3NCVYY3WS27HF0HKANA3R9FP8
                  custom_attribute:
                    key: square:a0f1505a-2aa1-490d-91a8-8d31ff181808
                    value: '10.5'
                    version: 1
                    visibility: VISIBILITY_READ_WRITE_VALUES
                    updated_at: '2021-12-09T00:16:23Z'
                    created_at: '2021-12-08T23:14:47Z'
                  errors:
                    - category: API_ERROR
                      code: INTERNAL_SERVER_ERROR
                id5:
                  customer_id: 70548QG1HN43B05G0KCZ4MMC1G
                  custom_attribute:
                    key: sq0ids-0evKIskIGaY45fCyNL66aw:backupemail
                    value: fake-email@squareup.com
                    version: 2
                    visibility: VISIBILITY_READ_WRITE_VALUES
                    updated_at: '2021-12-09T00:16:23Z'
                    created_at: '2021-12-09T00:16:20Z'
                  errors:
                    - category: API_ERROR
                      code: INTERNAL_SERVER_ERROR
              errors:
                - category: API_ERROR
                  code: INTERNAL_SERVER_ERROR
                  detail: detail
                  field: field
    serach:
      path: /v2/customers/search
      method: POST
      auth: true
      docs: >-
        Searches the customer profiles associated with a Square account using
        one or more supported query filters.


        Calling `SearchCustomers` without any explicit query filter returns all

        customer profiles ordered alphabetically based on `given_name` and

        `family_name`.


        Under normal operating conditions, newly created or updated customer
        profiles become available

        for the search operation in well under 30 seconds. Occasionally,
        propagation of the new or updated

        profiles can take closer to one minute or longer, especially during
        network incidents and outages.
      display-name: SearchCustomers
      request:
        name: SearchCustomersRequest
        body:
          properties:
            cursor:
              type: optional<string>
              docs: >-
                Include the pagination cursor in subsequent calls to this
                endpoint to retrieve

                the next set of results associated with the original query.


                For more information, see
                [Pagination](https://developer.squareup.com/docs/build-basics/common-api-patterns/pagination).
            limit:
              type: optional<long>
              docs: >-
                The maximum number of results to return in a single page. This
                limit is advisory. The response might contain more or fewer
                results.

                If the specified limit is invalid, Square returns a `400
                VALUE_TOO_LOW` or `400 VALUE_TOO_HIGH` error. The default value
                is 100.


                For more information, see
                [Pagination](https://developer.squareup.com/docs/build-basics/common-api-patterns/pagination).
            query:
              type: optional<root.CustomerQuery>
              docs: >-
                Query customers based on the given conditions and sort order.

                Calling `SearchCustomers` without an explicit query parameter
                returns

                all customers ordered alphabetically based on `given_name` and

                `family_name`.
      response:
        docs: Success
        type: root.SearchCustomersResponse
      examples:
        - request:
            limit: 2
            query:
              filter:
                creation_source:
                  values:
                    - THIRD_PARTY
                  rule: INCLUDE
                created_at:
                  start_at: '2018-01-01T00:00:00-00:00'
                  end_at: '2018-02-01T00:00:00-00:00'
                email_address:
                  fuzzy: example.com
                group_ids:
                  all:
                    - 545AXB44B4XXWMVQ4W8SBT3HHF
              sort:
                field: CREATED_AT
                order: ASC
          response:
            body:
              errors:
                - category: API_ERROR
                  code: INTERNAL_SERVER_ERROR
                  detail: detail
                  field: field
              customers:
                - id: JDKYHBWT1D4F8MFH63DBMEN8Y4
                  created_at: '2018-01-23T20:21:54.859Z'
                  updated_at: '2020-04-20T10:02:43.083Z'
                  cards:
                    - {}
                  given_name: James
                  family_name: Bond
                  nickname: nickname
                  company_name: company_name
                  email_address: james.bond@example.com
                  address:
                    address_line_1: 505 Electric Ave
                    address_line_2: Suite 600
                    locality: New York
                    administrative_district_level_1: NY
                    postal_code: '10003'
                    country: US
                  phone_number: 1-212-555-4250
                  birthday: birthday
                  reference_id: YOUR_REFERENCE_ID_2
                  note: note
                  preferences:
                    email_unsubscribed: false
                  groups:
                    - id: id
                      name: name
                  creation_source: DIRECTORY
                  group_ids:
                    - 545AXB44B4XXWMVQ4W8SBT3HHF
                  segment_ids:
                    - 1KB9JE5EGJXCW.REACHABLE
                  version: 7
                - id: A9641GZW2H7Z56YYSD41Q12HDW
                  created_at: '2018-01-30T14:10:54.859Z'
                  updated_at: '2018-03-08T18:25:21.342Z'
                  cards:
                    - {}
                  given_name: Amelia
                  family_name: Earhart
                  nickname: nickname
                  company_name: company_name
                  email_address: amelia.earhart@example.com
                  address:
                    address_line_1: 500 Electric Ave
                    address_line_2: Suite 600
                    locality: New York
                    administrative_district_level_1: NY
                    postal_code: '10003'
                    country: US
                  phone_number: 1-212-555-9238
                  birthday: birthday
                  reference_id: YOUR_REFERENCE_ID_1
                  note: a customer
                  preferences:
                    email_unsubscribed: false
                  groups:
                    - id: id
                      name: name
                  creation_source: THIRD_PARTY
                  group_ids:
                    - 545AXB44B4XXWMVQ4W8SBT3HHF
                  segment_ids:
                    - 1KB9JE5EGJXCW.REACHABLE
                  version: 1
              cursor: 9dpS093Uy12AzeE
    get:
      path: /v2/customers/{customer_id}
      method: GET
      auth: true
      docs: Returns details for a single customer.
      path-parameters:
        customer_id:
          type: string
          docs: The ID of the customer to retrieve.
      display-name: RetrieveCustomer
      response:
        docs: Success
        type: root.GetCustomerResponse
      examples:
        - path-parameters:
            customer_id: customer_id
          response:
            body:
              errors:
                - category: API_ERROR
                  code: INTERNAL_SERVER_ERROR
                  detail: detail
                  field: field
              customer:
                id: JDKYHBWT1D4F8MFH63DBMEN8Y4
                created_at: '2016-03-23T20:21:54.859Z'
                updated_at: '2016-03-23T20:21:54.859Z'
                cards:
                  - {}
                given_name: Amelia
                family_name: Earhart
                nickname: nickname
                company_name: company_name
                email_address: Amelia.Earhart@example.com
                address:
                  address_line_1: 500 Electric Ave
                  address_line_2: Suite 600
                  address_line_3: address_line_3
                  locality: New York
                  sublocality: sublocality
                  sublocality_2: sublocality_2
                  sublocality_3: sublocality_3
                  administrative_district_level_1: NY
                  administrative_district_level_2: administrative_district_level_2
                  administrative_district_level_3: administrative_district_level_3
                  postal_code: '10003'
                  country: US
                  first_name: first_name
                  last_name: last_name
                phone_number: 1-212-555-4240
                birthday: birthday
                reference_id: YOUR_REFERENCE_ID
                note: a customer
                preferences:
                  email_unsubscribed: false
                groups:
                  - id: id
                    name: name
                creation_source: THIRD_PARTY
                group_ids:
                  - 545AXB44B4XXWMVQ4W8SBT3HHF
                segment_ids:
                  - 1KB9JE5EGJXCW.REACHABLE
                version: 1
                tax_ids:
                  eu_vat: eu_vat
    update:
      path: /v2/customers/{customer_id}
      method: PUT
      auth: true
      docs: >-
        Updates a customer profile. To change an attribute, specify the new
        value. To remove an attribute, specify the value as an empty string or
        empty object.


        As a best practice, you should include the `version` field in the
        request to enable [optimistic
        concurrency](https://developer.squareup.com/docs/working-with-apis/optimistic-concurrency)
        control. The value must be set to the current version of the customer
        profile.


        To update a customer profile that was created by merging existing
        profiles, you must use the ID of the newly created profile.


        You cannot use this endpoint to change cards on file. To make changes,
        use the [Cards API](api:Cards) or [Gift Cards API](api:GiftCards).
      path-parameters:
        customer_id:
          type: string
          docs: The ID of the customer to update.
      display-name: UpdateCustomer
      request:
        name: UpdateCustomerRequest
        body:
          properties:
            given_name:
              type: optional<string>
              docs: >-
                The given name (that is, the first name) associated with the
                customer profile.
            family_name:
              type: optional<string>
              docs: >-
                The family name (that is, the last name) associated with the
                customer profile.
            company_name:
              type: optional<string>
              docs: A business name associated with the customer profile.
            nickname:
              type: optional<string>
              docs: A nickname for the customer profile.
            email_address:
              type: optional<string>
              docs: The email address associated with the customer profile.
            address:
              type: optional<root.Address>
              docs: >-
                The physical address associated with the customer profile. To
                make any changes to an address, you must provide the complete
                `Address` object. 

                Sparse updates are not supported for this object, so any fields
                that are undefined in the request are removed from the object.
            phone_number:
              type: optional<string>
              docs: >-
                The phone number associated with the customer profile. A phone
                number can contain 9–16 digits, with an optional `+` prefix.
            reference_id:
              type: optional<string>
              docs: >-
                An optional second ID used to associate the customer profile
                with an

                entity in another system.
            note:
              type: optional<string>
              docs: A custom note associated with the customer profile.
            birthday:
              type: optional<string>
              docs: >-
                The birthday associated with the customer profile, in RFC 3339
                format. The year is optional. The timezone and time are not
                allowed.

                For example, `0000-09-21T00:00:00-00:00` represents a birthday
                on September 21 and `1998-09-21T00:00:00-00:00` represents a
                birthday on September 21, 1998.

                You can also specify this value in `YYYY-MM-DD` format.
            version:
              type: optional<long>
              docs: >-
                The current version of the customer profile.


                As a best practice, you should include this field to enable
                [optimistic
                concurrency](https://developer.squareup.com/docs/build-basics/common-api-patterns/optimistic-concurrency)
                control. For more information, see [Update a customer
                profile](https://developer.squareup.com/docs/customers-api/use-the-api/keep-records#update-a-customer-profile).
            tax_ids:
              type: optional<root.CustomerTaxIds>
              docs: >-
                The tax ID associated with the customer profile. This field is
                available only for customers of sellers in EU countries or the
                United Kingdom. 

                In other countries, this field is ignored when included in an
                `UpdateCustomer` request. For more information, 

                see [Customer tax
                IDs](https://developer.squareup.com/docs/customers-api/what-it-does#customer-tax-ids).
      response:
        docs: Success
        type: root.UpdateCustomerResponse
      examples:
        - path-parameters:
            customer_id: customer_id
          request:
            email_address: New.Amelia.Earhart@example.com
            phone_number: ''
            note: updated customer note
            version: 2
          response:
            body:
              errors:
                - category: API_ERROR
                  code: INTERNAL_SERVER_ERROR
                  detail: detail
                  field: field
              customer:
                id: JDKYHBWT1D4F8MFH63DBMEN8Y4
                created_at: '2016-03-23T20:21:54.859Z'
                updated_at: '2016-05-15T20:21:55Z'
                cards:
                  - {}
                given_name: Amelia
                family_name: Earhart
                nickname: nickname
                company_name: company_name
                email_address: New.Amelia.Earhart@example.com
                address:
                  address_line_1: 500 Electric Ave
                  address_line_2: Suite 600
                  address_line_3: address_line_3
                  locality: New York
                  sublocality: sublocality
                  sublocality_2: sublocality_2
                  sublocality_3: sublocality_3
                  administrative_district_level_1: NY
                  administrative_district_level_2: administrative_district_level_2
                  administrative_district_level_3: administrative_district_level_3
                  postal_code: '10003'
                  country: US
                  first_name: first_name
                  last_name: last_name
                phone_number: phone_number
                birthday: birthday
                reference_id: YOUR_REFERENCE_ID
                note: updated customer note
                preferences:
                  email_unsubscribed: false
                groups:
                  - id: id
                    name: name
                creation_source: THIRD_PARTY
                group_ids:
                  - group_ids
                segment_ids:
                  - segment_ids
                version: 3
                tax_ids:
                  eu_vat: eu_vat
    delete:
      path: /v2/customers/{customer_id}
      method: DELETE
      auth: true
      docs: >-
        Deletes a customer profile from a business. This operation also unlinks
        any associated cards on file. 


        As a best practice, you should include the `version` field in the
        request to enable [optimistic
        concurrency](https://developer.squareup.com/docs/working-with-apis/optimistic-concurrency)
        control. The value must be set to the current version of the customer
        profile. 


        To delete a customer profile that was created by merging existing
        profiles, you must use the ID of the newly created profile.
      path-parameters:
        customer_id:
          type: string
          docs: The ID of the customer to delete.
      display-name: DeleteCustomer
      request:
        name: CustomersDeleteRequest
        query-parameters:
          version:
            type: optional<long>
            docs: >-
              The current version of the customer profile.


              As a best practice, you should include this parameter to enable
              [optimistic
              concurrency](https://developer.squareup.com/docs/build-basics/common-api-patterns/optimistic-concurrency)
              control.  For more information, see [Delete a customer
              profile](https://developer.squareup.com/docs/customers-api/use-the-api/keep-records#delete-customer-profile).
      response:
        docs: Success
        type: root.DeleteCustomerResponse
      examples:
        - path-parameters:
            customer_id: customer_id
          response:
            body:
              errors:
                - category: API_ERROR
                  code: INTERNAL_SERVER_ERROR
                  detail: detail
                  field: field
  source:
    openapi: openapi/openapi.yaml
